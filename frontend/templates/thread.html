{{/* Thread pagination - expects Pagination with CurrentPage, TotalPages */}}
{{define "thread-pagination"}}
{{if and .Pagination (gt .Pagination.TotalPages 1)}}
{{$p := .Pagination}}
<div class="pagination">
    {{if gt $p.CurrentPage 1}}<a href="?page={{sub $p.CurrentPage 1}}">&lt;&lt; prev</a>{{end}}
    <form class="page-form" method="get" action=""><input type="number" class="page-input" name="page" value="{{$p.CurrentPage}}" min="1" max="{{$p.TotalPages}}"> / {{$p.TotalPages}}</form>
    {{if lt $p.CurrentPage $p.TotalPages}}<a href="?page={{add $p.CurrentPage 1}}">next &gt;&gt;</a>{{end}}
</div>
{{end}}
{{end}}

{{define "title"}}/{{ .Thread.Board }}/ - Thread No.{{ .Thread.Id }}{{end}}
{{define "content"}}
    <div class="board-header">
        <h1><a href="/{{ .Thread.Board }}">/{{ .Thread.Board }}/</a></h1>
        <hr>
    </div>

    <div class="thread-header">
        <span class="nav-links">[<a href="/{{ .Thread.Board }}/">Return</a>] [<a href="#">Top</a>] [<a href="#bottom">Bottom</a>]</span>
    </div>

    {{template "thread-pagination" .Thread}}

    <div class="posts-container">
        {{ range $index, $message := .Thread.Messages }}
            {{/* Context already populated by RenderThread - just pass Message + User + CSRFToken! */}}
            {{template "post" (dict
                "Message" $message
                "User" $.User
                "CSRFToken" $.CSRFToken
            )}}
        {{ end }}
    </div><!-- End posts-container -->
    <br clear="left"> <!-- Clear floats/inline-blocks -->

    {{template "thread-pagination" .Thread}}

    <hr class="post-separator"> <!-- Separator before bottom reply form -->

    <!-- Reply Form (Bottom) -->
     <div class="post-form-container" id="reply-form-bottom">
        <form action="/{{ .Thread.Board }}/{{ .Thread.Id }}" method="post" enctype="multipart/form-data">
             {{template "csrf-field" .}}
             <input type="hidden" name="form_action" value="reply">
             <table class="form-table">
                 <tbody>
                     <tr>
                         <td class="form-label"><label for="text-reply-bottom">Comment:</label></td>
                         <td>
                             <textarea id="text-reply-bottom" name="text" cols="48" rows="4" maxlength="{{.Validation.MessageTextMaxLen}}"></textarea>
                         </td>
                     </tr>
                     <tr>
                         <td class="form-label"><label for="attachments-reply-bottom">File:</label></td>
                         <td>{{template "file-input" dict "InputID" "attachments-reply-bottom" "MaxCount" .Validation.MaxAttachmentsPerMessage "MaxTotalSize" .Validation.MaxTotalAttachmentSize "MaxFileSize" .Validation.MaxAttachmentSizeBytes "AllowedImages" .Validation.AllowedImageMimeTypes "AllowedVideos" .Validation.AllowedVideoMimeTypes}}</td>
                     </tr>
                     <tr>
                         <td class="form-label"></td>
                         <td><label><input type="checkbox" name="show_company"> Show my company</label></td>
                     </tr>
                     <tr>
                         <td class="form-label"></td>
                         <td><button type="submit">Post</button></td>
                     </tr>
                 </tbody>
             </table>
        </form>
    </div>

    <div id="bottom"></div>
    <hr>
    <span class="nav-links">[<a href="/{{ .Thread.Board }}/">Return</a>] [<a href="#">Top</a>] [<a href="#bottom">Bottom</a>]</span>

    {{template "popup-reply-form" .}}
{{ end }}